# 10 해시  

해시법은 검색뿐만 아니라 데이터의 추가와 삭제도 효율적으로 수행할 수 있는 방법이다.  

## 10-1 해시법  
정렬된 배열에 새로운 값을 추가/삭제할 경우, 요소 이동에 필요한 복잡도는 O(n)으로 비용이 크다.  

**해시법(hashing)은 데이터를 저장할 위치(인덱스)를 간단한 연산으로 구하여 검색, 추가, 삭제를 효율적으로 수행한다.**  
키값을 해시값으로 변환하는 과정을 **해시 함수(hash function)** 라고 한다. 해시 테이블의 요소는 **버킷**이라고 한다.  

### 충돌  
키값과 해시값의 대응 관계가 1대n인 경우, 이렇게 `저장할 버킷이 중복되는 현상`을 **충돌(collision)** 이라고 한다.  

충돌 대처법은 다음 2가지 방법이 있다.  
- **체인법**: 해시값이 같은 요소를 연결 리스트로 관리한다.  
- **오픈 주소법**: 빈 버킷을 찾을 때까지 해시를 반복한다.  

<br>

### 체인법  
체인법은 `해시값이 같은 데이터를 사슬(chain) 모양의 연결 리스트로 연결하는 방법`으로, 오픈 해시법(open hashing)이라고도 한다.  
연결리스트를 구현하기 위한 버킷용 클래스 Node<K,V>는 다음과 같은 필드를 가지고 있다.   
- key: 키값(자료형 K는 임의의 자료형)
- data: 데이터(자료형 V는 임의의 자료형)
- next: 체인에서 다음 노드에 대한 참조(자료형은 Node<K,V>)

Node<K,V>는 다음과 같은 메서들를 가지고 있다.  
- getKey: 키값(key)을 그대로 반환한다.
- getValue: 데이터(data)를 그대로 반환한다.
- hashCode: 키값의 해시값을 반환한다.  

해시 클래스 ChainHash<K,V>는 다음과 같은 필드를 가진다.  
- size: 해시 테이블의 용량(배열 table의 요솟수)  
- table: 해시 테이블을 저장하는 배열   // ex) private Node<K,V>[] table;

<br>

> 해시와 해시 함수 알아보기   
> 
> 만약 충돌이 전혀 발생하지 않는다면 해시 함수로 인덱스를 구하는 것만으로 검색, 추가, 삭제가 거의 완료되므로 시간 복잡도는 모두 O(1)이 된다.  
> 해시 테이블을 크게 하면 충돌 발생을 억제할 수는 있지만 다른 한편으로 메모리를 쓸데없이 많이 차지하게 된다. 
> 즉, **시간과 공간의 절충(Time-Space Trade Off)** 이라는 문제가 항상 따라다닌다.  
> 충돌을 피하려면 해시 함수는 해시 테이블 용량 이하의 정수를 되도록이면 한쪽으로 치우치지 않도록 고르게 만들어 내야 한다. 그래서 해시 테이블 용량은 소수가 좋다고 알려져 있다.  
> 위의 Node<K,V>와 Bucket<K,V>의 hashCode 메서드는 java.lang.Object 클래스에서 정의한 메서드를 오버라이드한 것이다.  

<br>

- 키값으로 요소를 검색하는 search 메서드  
  1. 해시 함수로 키값을 해시값으로 변환한다.
  2. 해시값을 인덱스로 하는 버킷을 선택한다.
  3. 선택한 버킷의 연결 리스트를 처음부터 순서대로 선형 검색한다. 키값과 같은 값을 찾으면 검색 성공이다. 끝까지 스캔하여 찾지 못하면 검색 실패이다.  
<br>
- 요소를 추가하는 add 메서드  
  1. 해시 함수가 키값을 해시값으로 변환한다.
  2. 해시값을 인덱스로 하는 버킷을 선택한다.
  3. 버킷이 가리키는 연결리스트를 처음부터 순서대로 검색한다. 키값과 같은 값을 찾으면 키값이 이미 등록된 상태이므로 삽입에 실패한다. 끝까지 스캔하여 찾지 못하면 리스트의 맨 앞에 노드를 삽입한다.  
     <br>
- 요소를 삭제하는 remove 메서드  
  1. 해시 함수로 키값을 해시값으로 변환한다.
  2. 해시값을 인덱스로 하는 버킷을 선택한다.
  3. 버킷이 가리키는 연결 리스트를 처음부터 순서대로 검색한다. 키값과 같은 값을 찾으면 그 노드를 리스트에서 삭제한다. 그렇지 않으면 삭제에 실패한다.

<br>

### 오픈 주소법
또다른 해시법인 오픈 주소법(open addressing)은 `충돌이 발생했을 때 재해시를 수행하여 비어 있는 버킷을 찾아내는 방법`으로, 닫힌 해시법(closed hashing)이라고도 한다.  




